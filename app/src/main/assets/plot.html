<?xml version="1.0" encoding="UTF-8"?>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, height=device-height, user-scalable=no">
</head>

<script src="plotly-latest.min.js"></script>

<body bgcolor="#fafafa">
<div id="tester" style="width:600px;height:250px;"></div>
</body>

<script>
    function graph(data, date) {
        var indexOfMaxValue = data.reduce((iMax, x, i, arr) => x > arr[iMax] ? i : iMax, 0);
        var layout = {
            autosize: true,
            shapes: [
        // 1st highlight during Feb 4 - Feb 6
        {
            type: 'rect',
            // x-reference is assigned to the x-values
            xref: 'x',
            // y-reference is assigned to the plot paper [0,1]
            yref: 'paper',
            x0: '2021-06-05',
            y0: 0,
            x1: '2021-06-07',
            y1: 1,
            fillcolor: '#d3d3d3',
            opacity: 0.2,
            line: {
                width: 0
            }
        },

        // 2nd highlight during Feb 20 - Feb 23

        {
            type: 'rect',
            xref: 'x',
            yref: 'paper',
            x0: '2021-05-29',
            y0: 0,
            x1: '2021-05-31',
            y1: 1,
            fillcolor: '#d3d3d3',
            opacity: 0.2,
            line: {
                width: 0
            }
        }
    ],
            height: 500,
            width: 500,
            font: {
    size: 16,
    color: '#7f7f7f'
  },
   yaxis: {
    title: 'Frequency',
    tickvals: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
    tickmode: 'array',
    automargin: true,
    rangemode: 'tozero'
  },
  xaxis: {
    range: [date[0], date[date.length - 1]],
    title: 'Time',
    type: 'date',
    automargin: true,
    fixedrange: true,
  },
      annotations: [{
    xref: 'x',
    yref: 'y',
    x: indexOfMaxValue,
    xanchor: 'left',
    y: Math.max(...data),
    yanchor: 'top',
    text: 'Maximum',
    showarrow: false
  }],
             paper_bgcolor: '#fafafa',
             plot_bgcolor: '#fafafa'
            };


	    TESTER = document.getElementById('tester');
	    Plotly.newPlot( TESTER, [{
	    x: date,
	    y: data,  type: 'scatter' }], layout );
	 console.log(Math.max(...data));
	 console.log(data);
	 var indexOfMaxValue = data.reduce((iMax, x, i, arr) => x > arr[iMax] ? i : iMax, 0);
	 console.log(indexOfMaxValue);

    document.getElementById("tester").on('plotly_click', function(data){
        console.log(data.points[0].x);
        window.open(data.points[0].x, "_blank");
    });
	}
</script>

</html>